# VaultKVSecret

Represents a KV secret stored in a `VaultKVSecretEngine`. Configuring an engine
is mandatory, there is no default engine.

Each secret can have one or more fields. Each field can represent:

- A static value: In that case the secret has to be first encrypted using
  Heists managed Transit Engine. The Transit Engine is mounted at
  `managed/transit` and contains a key called `encryption-key` which can be
  used for that purpose.
- An auto generated value: This securely generates a random secret value for
  each deployment. Once generated the secret value will be fixed for that
  deployment. Auto generated values are 64 characters long per default, but
  length is configurable.

## Example

```yaml
apiVersion: heist.youniqx.com/v1alpha1
kind: VaultKVSecret
metadata:
  name: example-secret
spec:
  engine: example-kv-secret-engine
  fields:
    example_autogenerated_field:
      autoGenerated: true
    example_short_autogenerated_field:
      autoGenerated: true
      autoGeneratedLength: 10
    example_static_field:
      ciphertext: vault:v1:uu8YASXKaP0f62+vDS4Z0m3iv3tW0GhSiI8wU8iNU0A=
```

## Field Configuration

Each field configured under `fields` has the following configuration options.
Values for the fields are the default values:

```yaml
autoGenerated: false
autoGeneratedLength: 64
ciphertext: ""
```

The fields `autoGenerated` and `ciphertext` are mutually exclusive. You cannot
set both at the same time.

For setting `ciphertext` the value has to be first encrypted using Heists
managed Transit Engine. The Transit Engine is mounted at `managed/transit` and
contains a key called `encryption-key` which can be used for that purpose.

## Full example

Here is an example with all fields set to their default value:

```yaml
apiVersion: heist.youniqx.com/v1alpha1
kind: VaultKVSecret
metadata:
  name: example-secret
spec:
  engine: ""
  fields: {}
  deleteProtection: false
  path: ""
```

The `path` field can be used to specify a relative path for the secret in the
secret engine - this has no effect on the functionality of Heist and just
changes how secrets are organized in Vault.
