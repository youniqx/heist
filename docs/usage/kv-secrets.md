# KV secrets

A KV secret is the most common type of secrets. It can be used to store simple
key-value pairs, e.g. passwords.

## KV secret engine

To use KV secrets you first have to create a KV secret engine. The KV secret
engine is a simple key value store and currently only supports version 2.

To create a new KV secret engine deploy a CRD of kind `VaultKVSecretEngine` and
give it a meaningful name.

Minimal configuration:

```yaml
apiVersion: heist.youniqx.com/v1alpha1
kind: VaultKVSecretEngine
metadata:
  name: example-kv-secret-engine
```

## KV secret

### Defined secret

```yaml
apiVersion: heist.youniqx.com/v1alpha1
kind: VaultKVSecret
metadata:
  name: example-secret
spec:
  engine: example-kv-secret-engine
  fields:
    example_static_field:
      ciphertext: vault:v1:uu8YASXKaP0f62+vDS4Z0m3iv3tW0GhSiI8wU8iNU0A=
```

### Auto generated secret

```yaml
apiVersion: heist.youniqx.com/v1alpha1
kind: VaultKVSecret
metadata:
  name: example-secret
spec:
  engine: example-kv-secret-engine
  fields:
    example_autogenerated_field:
      autoGenerated: true
```

### Auto generated secret with defined length

```yaml
apiVersion: heist.youniqx.com/v1alpha1
kind: VaultKVSecret
metadata:
  name: example-secret
spec:
  engine: example-kv-secret-engine
  fields:
    example_field:
      autoGenerated: true
      autoGeneratedLength: 10
```

### Secret with delete protection

```yaml
apiVersion: heist.youniqx.com/v1alpha1
kind: VaultKVSecret
metadata:
  name: example-secret
spec:
  engine: example-kv-secret-engine
  deleteProtection: true
  fields:
    example_field:
      autoGenerated: true
```

### Secret at a specific path

```yaml
apiVersion: heist.youniqx.com/v1alpha1
kind: VaultKVSecret
metadata:
  name: example-secret
spec:
  engine: example-kv-secret-engine
  path: folder/subfolder
  fields:
    example_field:
      ciphertext: vault:v1:uu8YASXKaP0f62+vDS4Z0m3iv3tW0GhSiI8wU8iNU0A=
```

### Secret with multiple fields

```yaml
apiVersion: heist.youniqx.com/v1alpha1
kind: VaultKVSecret
metadata:
  name: example-secret
spec:
  engine: example-kv-secret-engine
  deleteProtection: true
  path: folder/subfolder
  fields:
    example_field_one:
      ciphertext: vault:v1:uu8YASXKaP0f62+vDS4Z0m3iv3tW0GhSiI8wU8iNU0A=
    example_field_two:
      autoGenerated: true
      autoGeneratedLength: 10
```
